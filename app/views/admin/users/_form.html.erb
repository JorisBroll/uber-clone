<!-- Javascript -->
<script>
	init.push(function () {
		// Add phone validator
		$.validator.addMethod(
			"phone_format",
			function(value, element) {
				var check = false;
				return this.optional(element) || /^\(\d{3}\)[ ]\d{3}\-\d{4}$/.test(value);
			},
			"Invalid phone number."
		);

		// Setup validation
		$("#new_user").validate({
			ignore: '.ignore, .select2-input',
			focusInvalid: false,
			rules: {
				'user[email]': {
				  required: true,
				  email: true
				},
				'user[password]': {
					required: true,
					minlength: 6,
					maxlength: 20
				},
				'user[password_confirmation]': {
					required: true,
					minlength: 6,
					equalTo: "#user_password"
				},
			}
		});
		
		$("#user_account_type, #user_partner_id").select2({
			allowClear: true,
			placeholder: "Sélectionner..."
		});
	});

</script>
<!-- / Javascript -->

<div class="panel">
	<div class="panel-heading">
		<span class="panel-title">Informations</span>
	</div>
	<div class="panel-body">

		<%= form_for [:admin, @user] do |f| %>
			<%= render 'common/error_messages', object: f.object %>

			<div class="form-group">
				<%= f.label :name, class: "col-sm-3 control-label" %>
				<div class="col-sm-9">
					<%= f.text_field :name, class: "form-control", :placeholder => "Nom" %>
				</div>
			</div>

			<div class="form-group">
				<%= f.label :last_name, class: "col-sm-3 control-label" %>
				<div class="col-sm-9">
					<%= f.text_field :last_name, class: "form-control", :placeholder => "Nom" %>
				</div>
			</div>

			<div class="form-group">
				<%= f.label :email, class: "col-sm-3 control-label" %>
				<div class="col-sm-9">
					<%= f.text_field :email, class: "form-control", :placeholder => "Email" %>
				</div>
			</div>

			<div class="form-group">
				<%= f.label :phone, "Téléphone :", class: "col-sm-3 control-label" %>
				<div class="col-sm-9">
					<%= f.text_field :phone, class: "form-control", :placeholder => "Téléphone" %>
				</div>
			</div>

			<div class="form-group">
				<%= f.label :account_type, class: "col-sm-3 control-label" %>
				<div class="col-sm-9">
					<%= f.select(:account_type, User::Account_type_select, class: "form-control select") %>
				</div>
			</div>

			<div class="form-group">
				<%= f.label :password, class: "col-sm-3 control-label" %>
				<div class="col-sm-9">
					<%= f.password_field :password, class: "form-control", :placeholder => "Mot de passe" %>
				</div>
			</div>

			<div class="form-group">
				<%= f.label :password_confirmation, class: "col-sm-3 control-label" %>
				<div class="col-sm-9">
					<%= f.password_field :password_confirmation, class: "form-control", :placeholder => "Confirmation" %>
				</div>
			</div>

			<div class="form-group">
				<%= f.label :partner_id, class: "col-sm-3 control-label" %>
				<div class="col-sm-9">
					<%= f.select(:partner_id, partners_for_select('Aucune'), class: "form-control select") %>
				</div>
			</div>

			<%= hidden_field(:user, :created_by) %>

			<hr class="panel-wide" />
			<br />

			<div class="form-group">
				<div class="col-sm-9">
					<%= f.submit action, class: "btn btn-large btn-primary btn-flat" %>
				</div>
			</div>
		<% end %>
	</div>
</div>
